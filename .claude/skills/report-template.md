# 漏洞复现报告统一模版

## 模版目的

确保所有漏洞复现报告格式一致，结构清晰，信息完整。

---

## 报告结构规范

### 1. 标题格式（必须）

标题必须包含三个要素：**漏洞存在状态** + **复现方式** + **漏洞名称**

```markdown
# [漏洞存在] {VUL-ID} {漏洞名称} - {复现方式}复现报告
```

**示例**：
- `# [漏洞存在] VUL-001 SQL注入漏洞 - L2 API复现报告`
- `# [漏洞存在] VUL-002 权限绕过漏洞 - L3 Mock代码分析报告`
- `# [漏洞不存在] VUL-003 XSS漏洞 - L1 Playwright复现报告`
- `# [部分存在] VUL-004 CSRF漏洞 - L2 API复现报告`

---

### 2. 完整报告模版

```markdown
# [{漏洞状态}] {VUL-ID} {漏洞名称} - {复现方式}复现报告

---

## 复现结论

| 项目 | 内容 |
|------|------|
| **漏洞状态** | 存在 / 不存在 / 部分存在 |
| **危害等级** | 高 / 中 / 低 |
| **复现方式** | L1 Playwright / L2 API / L3 Mock |
| **复现日期** | YYYY-MM-DD |
| **目标地址** | http://xxx |

{如果是 L3 Mock 复现，添加真实性声明}

---

## 漏洞介绍

### 漏洞类型
{SQL注入 / XSS / CSRF / 越权访问 / 信息泄露 / RCE 等}

### 漏洞位置
- **端点**: {API路径或页面URL}
- **方法**: {HTTP方法}
- **参数**: {受影响的参数}
- **源码位置**: {文件:行号}（如果适用）

### 漏洞描述
{漏洞的详细描述，包括：
- 漏洞成因
- 攻击原理
- 潜在影响
}

---

## 复现过程

### 环境准备
{所需的环境、账号、数据等前提条件}

### 复现步骤

**步骤 1**: {描述}
```http
{请求/命令/操作}
```

**步骤 2**: {描述}
```http
{请求/命令/操作}
```

{继续添加步骤...}

### 复现结果
{实际观察到的现象，证明漏洞存在/不存在}

---

## 证据 {成功时展示}

### HTTP 请求
```http
{完整的HTTP请求}
```

### HTTP 响应
```http
{完整的HTTP响应，关键信息高亮}
```

### 截图
{如果有截图，添加路径}
![证据截图](evidence/{VUL-ID}/screenshots/xxx.png)

---

## PoC {漏洞存在时提供}

### 快速验证
```bash
{curl或单行命令}
```

### 完整 PoC 脚本
```python
#!/usr/bin/env python3
"""
漏洞: {漏洞名称}
目标: {目标地址}
用法: python poc.py <target_url>
"""

{完整可运行的PoC代码}
```

---

## 复现失败分析 {漏洞不存在时填写}

### 失败原因
{详细说明为什么无法复现}

### 可能的原因
1. {原因1：如版本已修复}
2. {原因2：如环境配置不同}
3. {原因3：如需要特殊前提条件}

### 建议
{后续验证建议}

---

## 修复建议 {漏洞存在时填写}

### 推荐修复方案
{具体的修复方法}

### 代码修复示例
```{language}
// 修复前
{有漏洞的代码}

// 修复后
{修复后的代码}
```

### 临时缓解措施
{在正式修复前的临时方案}

---

## 参考资料

- [CWE-xxx](https://cwe.mitre.org/data/definitions/xxx.html)
- [OWASP xxx](https://owasp.org/xxx)
```

---

## L3 Mock 特殊要求

当使用 L3 Mock 方式复现时，必须添加 **真实性声明** 部分：

```markdown
## 真实性声明

> **重要**: 本报告使用 L3 Mock 代码分析方式验证漏洞

### 验证方式说明

本次复现通过 **源代码静态分析** + **Mock 隔离测试** 完成，具有以下特点：

| 方面 | 说明 |
|------|------|
| **代码层验证** | 直接分析源代码逻辑，确认漏洞代码存在 |
| **逻辑可达性** | 通过代码路径分析，确认漏洞可被触发 |
| **Mock 隔离** | 模拟依赖组件，专注测试漏洞代码本身 |

### Mock 环境说明

| 组件 | Mock 方式 | 行为 |
|------|----------|------|
| {组件1} | {Mock类型} | {模拟行为} |
| {组件2} | {Mock类型} | {模拟行为} |

### 真实性保证

以下因素确保分析结果的可信度：

1. **代码真实**: 分析的是实际源代码，非模拟代码
2. **逻辑完整**: 漏洞代码路径完整，可追溯到入口点
3. **条件可达**: 分析表明在正常使用中可触发此代码路径
4. **行业标准**: 分析方法符合 SAST/代码审计行业标准

### 局限性说明

Mock 测试存在以下局限，供参考：

- [ ] 未包含全局性输入过滤/WAF 拦截
- [ ] 认证/权限检查可能被 Mock 绕过
- [ ] 真实环境的依赖交互可能存在差异
- [ ] 建议有条件时进行真实环境二次验证

### 可信度评级

| 可信度 | 适用情况 |
|--------|----------|
| **高** | 代码逻辑清晰，无外部依赖干扰 |
| **中** | 存在部分外部依赖，但主逻辑验证完整 |
| **低** | 依赖较多外部因素，需真实环境验证 |

**本漏洞可信度**: {高/中/低}
```

---

## 状态说明

### 漏洞状态定义

| 状态 | 说明 | 标记 |
|------|------|------|
| **存在** | 漏洞确认存在，可被利用 | `[漏洞存在]` |
| **不存在** | 漏洞无法复现，或已修复 | `[漏洞不存在]` |
| **部分存在** | 漏洞存在但有限制条件 | `[部分存在]` |

### 复现方式说明

| 方式 | 代码 | 说明 | 可信度 |
|------|------|------|--------|
| Playwright 黑盒 | L1 | 浏览器自动化复现 | 最高 |
| API 接口复现 | L2 | HTTP 请求直接验证 | 高 |
| Mock 代码分析 | L3 | 源码分析+隔离测试 | 中-高（需声明） |

---

## 使用指南

### 智能体使用此模版

所有复现智能体（playwright-executor, api-reproducer, mock-tester）必须：

1. **遵循模版结构**: 按照上述模版生成报告
2. **填写必填项**: 标题、复现结论、漏洞介绍、复现过程
3. **L3 必须声明**: 使用 Mock 方式时必须添加真实性声明
4. **提供 PoC**: 漏洞存在时必须提供可运行的 PoC
5. **说明失败原因**: 漏洞不存在时必须说明原因

### 报告命名规范

```
{VUL-ID}_{漏洞类型简写}.md

示例:
VUL-001_sqli.md
VUL-002_xss.md
VUL-003_idor.md
VUL-004_csrf.md
VUL-005_info-leak.md
```
